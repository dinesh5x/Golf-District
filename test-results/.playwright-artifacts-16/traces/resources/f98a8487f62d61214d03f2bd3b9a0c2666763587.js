"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8112],{78112:function(e,t,n){n.d(t,{eA:function(){return L},zB:function(){return E},w7:function(){return m},kP:function(){return p}});var s=n(57437),r=n(2265);class a extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),Error.captureStackTrace?.(this,this.constructor),this.name=e instanceof a?e.name:this.constructor.name}}class o extends a{}class i extends a{}async function c(e,t,n,s={}){let r=`${u(t)}/${e}`;try{let e={headers:{"Content-Type":"application/json",...s?.headers?.cookie?{cookie:s.headers.cookie}:{}}};s?.body&&(e.body=JSON.stringify(s.body),e.method="POST");let t=await fetch(r,e),n=await t.json();if(!t.ok)throw n;return n}catch(e){return n.error(new o(e.message,e)),null}}function u(e){return"undefined"==typeof window?`${e.baseUrlServer}${e.basePathServer}`:e.basePath}function l(){return Math.floor(Date.now()/1e3)}function d(e){let t=new URL("http://localhost:3000/api/auth");e&&!e.startsWith("http")&&(e=`https://${e}`);let n=new URL(e??t),s=("/"===n.pathname?t.pathname:n.pathname).replace(/\/$/,""),r=`${n.origin}${s}`;return{origin:n.origin,host:n.host,path:s,base:r,toString:()=>r}}var f=n(68571);let w={baseUrl:d(f.env.NEXTAUTH_URL??f.env.VERCEL_URL).origin,basePath:d(f.env.NEXTAUTH_URL).path,baseUrlServer:d(f.env.NEXTAUTH_URL_INTERNAL??f.env.NEXTAUTH_URL??f.env.VERCEL_URL).origin,basePathServer:d(f.env.NEXTAUTH_URL_INTERNAL??f.env.NEXTAUTH_URL).path,_lastSync:0,_session:void 0,_getSession:()=>{}};function h(){return"undefined"!=typeof BroadcastChannel?new BroadcastChannel("next-auth"):{postMessage:()=>{},addEventListener:()=>{},removeEventListener:()=>{}}}let v={debug:console.debug,error:console.error,warn:console.warn},g=r.createContext?.(void 0);function p(e){if(!g)throw Error("React Context is unavailable in Server Components");let t=r.useContext(g),{required:n,onUnauthenticated:s}=e??{},a=n&&"unauthenticated"===t.status;return(r.useEffect(()=>{if(a){let e=`/api/auth/signin?${new URLSearchParams({error:"SessionRequired",callbackUrl:window.location.href})}`;s?s():window.location.href=e}},[a,s]),a)?{data:t.data,update:t.update,status:"loading"}:t}async function _(e){let t=await c("session",w,v,e);return(e?.broadcast??!0)&&h().postMessage({event:"session",data:{trigger:"getSession"}}),t}async function y(){let e=await c("csrf",w,v);return e?.csrfToken}async function S(){return c("providers",w,v)}async function E(e,t,n){let{callbackUrl:s=window.location.href,redirect:r=!0}=t??{},a=u(w),o=await S();if(!o){window.location.href=`${a}/error`;return}if(!e||!(e in o)){window.location.href=`${a}/signin?${new URLSearchParams({callbackUrl:s})}`;return}let i="credentials"===o[e].type,c="email"===o[e].type,l=`${a}/${i?"callback":"signin"}/${e}`,d=`${l}?${new URLSearchParams(n)}`,f=await fetch(d,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...t,csrfToken:await y(),callbackUrl:s})}),h=await f.json();if(r||!(i||c)){let e=h.url??s;window.location.href=e,e.includes("#")&&window.location.reload();return}let v=new URL(h.url).searchParams.get("error");return f.ok&&await w._getSession({event:"storage"}),{error:v,status:f.status,ok:f.ok,url:v?null:h.url}}async function m(e){let{callbackUrl:t=window.location.href}=e??{},n=u(w),s={method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:await y(),callbackUrl:t})},r=await fetch(`${n}/signout`,s),a=await r.json();if(h().postMessage({event:"session",data:{trigger:"signout"}}),e?.redirect??!0){let e=a.url??t;window.location.href=e,e.includes("#")&&window.location.reload();return}return await w._getSession({event:"storage"}),a}function L(e){if(!g)throw Error("React Context is unavailable in Server Components");let{children:t,basePath:n,refetchInterval:a,refetchWhenOffline:o}=e;n&&(w.basePath=n);let u=void 0!==e.session;w._lastSync=u?l():0;let[d,f]=r.useState(()=>(u&&(w._session=e.session),e.session)),[p,S]=r.useState(!u);r.useEffect(()=>(w._getSession=async({event:e}={})=>{try{let t="storage"===e;if(t||void 0===w._session){w._lastSync=l(),w._session=await _({broadcast:!t}),f(w._session);return}if(!e||null===w._session||l()<w._lastSync)return;w._lastSync=l(),w._session=await _(),f(w._session)}catch(e){v.error(new i(e.message,e))}finally{S(!1)}},w._getSession(),()=>{w._lastSync=0,w._session=void 0,w._getSession=()=>{}}),[]),r.useEffect(()=>{let e=()=>w._getSession({event:"storage"});return h().addEventListener("message",e),()=>h().removeEventListener("message",e)},[]),r.useEffect(()=>{let{refetchOnWindowFocus:t=!0}=e,n=()=>{t&&"visible"===document.visibilityState&&w._getSession({event:"visibilitychange"})};return document.addEventListener("visibilitychange",n,!1),()=>document.removeEventListener("visibilitychange",n,!1)},[e.refetchOnWindowFocus]);let E=function(){let[e,t]=r.useState("undefined"!=typeof navigator&&navigator.onLine),n=()=>t(!0),s=()=>t(!1);return r.useEffect(()=>(window.addEventListener("online",n),window.addEventListener("offline",s),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}),[]),e}(),m=!1!==o||E;r.useEffect(()=>{if(a&&m){let e=setInterval(()=>{w._session&&w._getSession({event:"poll"})},1e3*a);return()=>clearInterval(e)}},[a,m]);let L=r.useMemo(()=>({data:d,status:p?"loading":d?"authenticated":"unauthenticated",async update(e){if(p||!d)return;S(!0);let t=await c("session",w,v,void 0===e?void 0:{body:{csrfToken:await y(),data:e}});return S(!1),t&&(f(t),h().postMessage({event:"session",data:{trigger:"getSession"}})),t}}),[d,p]);return(0,s.jsx)(g.Provider,{value:L,children:t})}}}]);