"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9936],{80599:function(e,l,s){s.d(l,{l:function(){return n}});var t=s(57437),i=s(2265);let n=e=>{let{isLoading:l,loadingText:s,children:n}=e;return(0,i.useEffect)(()=>(l?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[l]),(0,t.jsxs)("div",{className:" inset-0 flex justify-center items-center bg-black bg-opacity-40",style:{zIndex:l?999:-1,position:"fixed"},children:[l&&(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200",style:{width:"80px",height:"80px"},children:[(0,t.jsxs)("radialGradient",{id:"a9",cx:".66",fx:".66",cy:".3125",fy:".3125",gradientTransform:"scale(1.5)",children:[(0,t.jsx)("stop",{offset:"0",stopColor:"#225816"}),(0,t.jsx)("stop",{offset:".3",stopColor:"#225816",stopOpacity:".9"}),(0,t.jsx)("stop",{offset:".6",stopColor:"#225816",stopOpacity:".6"}),(0,t.jsx)("stop",{offset:".8",stopColor:"#225816",stopOpacity:".3"}),(0,t.jsx)("stop",{offset:"1",stopColor:"#225816",stopOpacity:"0"})]}),(0,t.jsx)("circle",{fill:"none",stroke:"url(#a9)",strokeWidth:"15",strokeLinecap:"round",strokeDasharray:"200 1000",strokeDashoffset:"0",cx:"100",cy:"100",r:"70",style:{transformOrigin:"center"},children:(0,t.jsx)("animateTransform",{type:"rotate",attributeName:"transform",calcMode:"spline",dur:"2",values:"360;0",keyTimes:"0;1",keySplines:"0 0 1 1",repeatCount:"indefinite"})}),(0,t.jsx)("circle",{fill:"none",opacity:".2",stroke:"#225816",strokeWidth:"15",strokeLinecap:"round",cx:"100",cy:"100",r:"70"})]}),(0,t.jsx)("div",{children:s})]}),(0,t.jsx)("div",{style:{display:l?"none":"block"},children:n})]})}},26590:function(e,l,s){s.d(l,{b:function(){return g}});var t=s(57437),i=s(80599),n=s(56922),a=s(16790),r=s(13028),o=s(27504),d=s(92316),c=s(24033),x=s(2265),u=s(83777),f=s(4680),m=s(63260),v=s(56102),p=s(7351),h=s(75197);let g=e=>{let{isCancelListingOpen:l,setIsCancelListingOpen:s,courseName:f,courseLogo:h,date:g,golferCount:y,pricePerGolfer:b,listingId:N,refetch:w,needRedirect:C}=e,{toggleSidebar:k}=(0,r.A)({isOpen:l,setIsOpen:s}),L=o.h.teeBox.cancelListing.useMutation(),I=(0,c.useRouter)(),[E,T]=(0,x.useState)(!1),{course:A}=(0,n.useCourseContext)(),S=null==A?void 0:A.id,{user:z}=(0,a.S)(),M=o.h.webhooks.auditLog.useMutation(),P=async()=>{var e;await M.mutateAsync({userId:null!==(e=null==z?void 0:z.id)&&void 0!==e?e:"",teeTimeId:"",bookingId:"",listingId:null!=N?N:"",courseId:S,eventId:"TEE_TIME_CANCELLED",json:"TEE_TIME_CANCELLED"})},O=async()=>{if(!N){u.Am.error("Listed already cancelled");return}T(!0);try{await L.mutateAsync({listingId:N}),await (null==w?void 0:w()),u.Am.success("Listing cancelled successfully"),s(!1),P(),C&&I.push("/".concat(null==A?void 0:A.id,"/my-tee-box"))}catch(l){var e;u.Am.error(null!==(e=null==l?void 0:l.message)&&void 0!==e?e:"Error cancelling listing")}finally{T(!1)}};return(0,t.jsxs)(t.Fragment,{children:[l&&(0,t.jsx)("div",{className:"fixed left-0 top-0 z-20 h-[100dvh] w-screen backdrop-blur ",children:(0,t.jsx)("div",{className:"h-screen bg-[#00000099]"})}),(0,t.jsx)(i.l,{isLoading:E,children:(0,t.jsx)("div",{})}),(0,t.jsx)("aside",{className:"!duration-400 fixed right-0 top-1/2 z-20 flex h-[90dvh] w-[80vw] -translate-y-1/2 flex-col overflow-y-hidden border border-stroke bg-white shadow-lg transition-all ease-linear sm:w-[500px] md:h-[100dvh] ".concat(l?"translate-x-0":"translate-x-full"),children:(0,t.jsxs)("div",{className:"relative flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,t.jsx)("div",{className:"text-lg",children:"Cancel Listing"}),(0,t.jsx)("button",{onClick:k,"aria-controls":"sidebar","aria-expanded":l,className:"z-[2]","aria-label":"sidebarToggle",children:(0,t.jsx)(p.x,{className:"h-[25px] w-[25px]"})})]}),(0,t.jsxs)("div",{className:"flex h-full flex-col justify-between overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-6 px-0 sm:px-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"px-4 pb-4 text-center text-2xl font-[300] md:text-3xl",children:"Are you sure you want to cancel this listing?"}),(0,t.jsx)(j,{courseName:null!=f?f:"",courseImage:null!=h?h:"",teeTimeDate:null!=g?g:"",golferCount:null!=y?y:0,timezoneCorrection:null==A?void 0:A.timezoneCorrection})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 rounded-xl bg-secondary-white px-4 py-5 text-center",children:[(0,t.jsx)("div",{className:"font-[300] text-primary-gray",children:"List price per golfer"}),(0,t.jsx)("div",{className:"text-lg md:text-2xl",children:(0,d.lb)(null!=b?b:0)}),(0,t.jsx)("div",{className:"h-[1px] w-full bg-stroke"}),(0,t.jsx)("div",{className:"font-[300] text-primary-gray",children:"Number of spots listed"}),(0,t.jsx)("div",{className:"text-lg md:text-2xl",children:y})]})]}),(0,t.jsx)("div",{className:"flex flex-col gap-4 px-4 pb-6",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(m.I,{className:"w-full",onClick:O,"data-testid":"cancel-listing-button-id",children:"Cancel Listing"}),(0,t.jsx)(v.f,{onClick:()=>s(!1),"data-testid":"cancel-button-id",children:"Cancel"})]})})]})]})})]})},j=e=>{let{courseName:l,courseImage:s,teeTimeDate:i,golferCount:n,timezoneCorrection:a}=e;return(0,t.jsxs)("div",{className:"flex flex-col gap-2 rounded-xl bg-secondary-white px-4 py-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(f.q,{src:s}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("div",{className:"whitespace-nowrap text-secondary-black",children:l}),(0,t.jsx)("div",{className:"text-primary-gray",children:(0,d.mr)(i,!1,a)})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 text-[14px]",children:[(0,t.jsx)("div",{className:"w-[40px] ",children:(0,t.jsx)(h.d,{className:"ml-auto w-[30px]"})}),n," ",1===n?"golfer":"golfers"]})]})}},83367:function(e,l,s){s.d(l,{u:function(){return C}});var t=s(57437),i=s(79467),n=s(80599),a=s(56922),r=s(16790),o=s(13028),d=s(27504),c=s(92316),x=s(24033),u=s(2265),f=s(83777),m=s(4680),v=s(63260),p=s(56102),h=s(39922),g=s(7351),j=s(53615),y=s(75197),b=s(59050),N=s(26590);let w=["1","2","3","4"],C=e=>{var l,s,m,y,C,L,I,E;let{isManageTeeTimeListingOpen:T,setIsManageTeeTimeListingOpen:A,selectedTeeTime:S,refetch:z,needRedirect:M}=e,[P,O]=(0,u.useState)(300),[_,F]=(0,u.useState)(0),[B,D]=(0,u.useState)(200),[H,R]=(0,u.useState)("1"),{toggleSidebar:q}=(0,o.A)({isOpen:T,setIsOpen:A}),[G,Q]=(0,u.useState)(!1);(0,x.useRouter)();let{course:W}=(0,a.useCourseContext)(),Y=null==W?void 0:W.id,$=(null!==(l=null==W?void 0:W.sellerFee)&&void 0!==l?l:1)/100,V=(null!==(s=null==W?void 0:W.buyerFee)&&void 0!==s?s:1)/100,{data:J}=d.h.teeBox.getOwnedBookingsForTeeTime.useQuery({teeTimeId:null!==(m=null==S?void 0:S.teeTimeId)&&void 0!==m?m:""},{enabled:!!(null==S?void 0:S.teeTimeId)}),K=4-((null==S?void 0:S.listedSlotsCount)||0);(0,u.useEffect)(()=>{if(S){var e;(null==S?void 0:S.listPrice)!==null&&O(null==S?void 0:S.listPrice),R(null==S?void 0:null===(e=S.listedSlotsCount)||void 0===e?void 0:e.toString())}},[S,T]),d.h.teeBox.updateListing.useMutation();let U=d.h.teeBox.cancelListing.useMutation(),X=d.h.webhooks.auditLog.useMutation(),{user:Z}=(0,r.S)(),[ee,el]=(0,u.useState)(!1),es=async()=>{var e,l;await X.mutateAsync({userId:null!==(e=null==Z?void 0:Z.id)&&void 0!==e?e:"",teeTimeId:"",bookingId:"",listingId:null!==(l=null==S?void 0:S.listingId)&&void 0!==l?l:"",courseId:Y,eventId:"TEE_TIME_CANCELLED",json:"TEE_TIME_CANCELLED"})},et=async()=>{if(!(null==S?void 0:S.listingId)){f.Am.error("Listed already cancelled");return}el(!0);try{await U.mutateAsync({listingId:null==S?void 0:S.listingId}),await (null==z?void 0:z()),f.Am.success("Listing cancelled successfully"),A(!1),es()}catch(l){var e;f.Am.error(null!==(e=null==l?void 0:l.message)&&void 0!==e?e:"Error cancelling listing")}finally{el(!1)}};(0,u.useEffect)(()=>{T?document.body.classList.add("overflow-hidden"):(document.body.classList.remove("overflow-hidden"),O(300))},[T]);let ei=(0,u.useMemo)(()=>{if(!P||P<=0)return F(0),0;console.log("selectedTeeTime?.firstHandPrice = ".concat(null==S?void 0:S.firstHandPrice));let e=parseFloat(P.toString()),l=e*$,s=(e*(1+V)-e*V-l)*parseInt(H);return s=s<=0?0:s,F(l*parseInt(H)),Math.abs(s)},[P,H]);return(0,u.useMemo)(()=>(null==S?void 0:S.firstHandPrice)?(null==S?void 0:S.firstHandPrice)*50:0,[S]),(0,t.jsxs)(t.Fragment,{children:[T&&(0,t.jsx)("div",{className:"fixed left-0 top-0 z-20 h-[100dvh] w-screen backdrop-blur ",children:(0,t.jsx)("div",{className:"h-screen bg-[#00000099]"})}),(0,t.jsx)(n.l,{isLoading:ee,children:(0,t.jsx)("div",{})}),(0,t.jsx)("aside",{className:"!duration-400 fixed right-0 top-1/2 z-20 flex h-[90dvh] w-[80vw] -translate-y-1/2 flex-col overflow-y-hidden border border-stroke bg-white shadow-lg transition-all ease-linear sm:w-[500px] md:h-[100dvh] ".concat(T?"translate-x-0":"translate-x-full"),children:(0,t.jsxs)("div",{className:"relative flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,t.jsx)("div",{className:"text-lg",children:"Manage Tee Time Listing"}),(0,t.jsx)("button",{onClick:q,"aria-controls":"sidebar","aria-expanded":T,className:"z-[2]","aria-label":"sidebarToggle","data-testid":"close-button-id",children:(0,t.jsx)(g.x,{className:"h-[25px] w-[25px]"})})]}),(0,t.jsxs)("div",{className:"flex h-full flex-col justify-between overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-6 px-0 sm:px-4",children:[(0,t.jsx)(k,{courseImage:null!==(y=null==S?void 0:S.courseLogo)&&void 0!==y?y:"",courseName:null!==(C=null==S?void 0:S.courseName)&&void 0!==C?C:"",courseDate:null!==(L=null==S?void 0:S.date)&&void 0!==L?L:"",golferCount:null!==(I=null==S?void 0:S.listedSlotsCount)&&void 0!==I?I:1,timezoneCorrection:null==W?void 0:W.timezoneCorrection}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 text-center w-fit mx-auto",children:[(0,t.jsx)("label",{htmlFor:"listingPrice",className:"text-[16px] text-primary-gray md:text-[18px]",children:"Listing price per golfer"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-1 top-1 text-[24px] md:text-[32px]",children:"$"}),(0,t.jsx)("input",{id:"listingPrice",value:null==P?void 0:P.toFixed(2),type:"number",onFocus:()=>{P||O(0),B||D(0)},onChange:e=>{let l=e.target.value.replace(/[$,]/g,""),s=l.split(".")[1];s&&(null==s?void 0:s.length)>2||O(Number(l.replace(/^0+/,"")))},onBlur:()=>{P||O(0),B||D(0)},className:"mx-auto max-w-[300px] rounded-lg bg-secondary-white px-4 py-1 text-center text-[24px] font-semibold outline-none md:text-[32px] pl-6","data-testid":"lsiting-price-id",disabled:!0})]})]}),(0,t.jsxs)("div",{className:"flex  flex-col gap-1 text-center",children:[(0,t.jsx)("label",{htmlFor:"spot",className:"text-[16px] text-primary-gray md:text-[18px]",children:"Number of spots listed"}),(0,t.jsx)(i.fC,{id:"spots",type:"single",value:H,onValueChange:e=>{!(K<parseInt(e))&&e&&R(e)},orientation:"horizontal",className:"mx-auto flex","data-testid":"player-button-id",disabled:!0,children:w.map((e,l)=>(0,t.jsx)(h.c,{value:e,className:"opacity-50 ".concat(0===l?"rounded-l-full border border-stroke":l===w.length-1?"rounded-r-full border-b border-t border-r border-stroke":"border-b border-r border-t border-stroke"," px-[1.75rem] ").concat(K<l+1?"opacity-50 cursor-not-allowed":""),dataTestId:"player-item-id",dataQa:e},l))})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 px-4 pb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"font-[300] text-primary-gray",children:"Your Listing Price"}),(0,t.jsx)("div",{className:"text-secondary-black",children:(0,c.lb)(P*Number(H))})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("div",{className:"font-[300] text-primary-gray",children:["Service Fee"," ",(0,t.jsx)(b.u,{trigger:(0,t.jsx)(j.k,{className:"h-[14px] w-[14px]"}),content:"This fee ensures ongoing enhancements to our service, ultimately offering golfers the best access to booking tee times"})]}),(0,t.jsx)("div",{className:"text-secondary-black",children:(0,c.lb)(_)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"font-[300] text-primary-gray",children:"You Receive after Sale"}),(0,t.jsx)("div",{className:"text-secondary-black",children:(0,c.lb)(ei)})]}),(0,t.jsx)("div",{className:"text-center text-[14px] font-[300] text-primary-gray",children:"All sales are final."}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(v.I,{className:"w-full",onClick:et,"data-testid":"cancel-listing-button-id",children:"Cancel Listing"}),(0,t.jsx)(p.f,{onClick:()=>A(!1),"data-testid":"cancel-button-id",children:"Cancel"})]})]})]})]})}),(0,t.jsx)(N.b,{isCancelListingOpen:G,setIsCancelListingOpen:Q,courseName:null==S?void 0:S.courseName,courseLogo:null==S?void 0:S.courseLogo,date:null==S?void 0:S.date,golferCount:null==S?void 0:S.listedSlotsCount,pricePerGolfer:(null==S?void 0:S.listPrice)?(null==S?void 0:S.listPrice)/100:0,listingId:null!==(E=null==S?void 0:S.listingId)&&void 0!==E?E:void 0,refetch:z,needRedirect:M})]})},k=e=>{let{courseImage:l,courseName:s,courseDate:i,golferCount:n,timezoneCorrection:a}=e;return(0,t.jsxs)("div",{className:"flex flex-col gap-2 rounded-xl bg-secondary-white px-4 py-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(m.q,{src:l}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("div",{className:"whitespace-nowrap text-secondary-black",children:s}),(0,t.jsx)("div",{className:"text-primary-gray",children:(0,c.mr)(i,!1,a)})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 text-[14px]",children:[(0,t.jsx)("div",{className:"w-[40px] ",children:(0,t.jsx)(y.d,{className:"ml-auto w-[30px]"})}),n," ",1===n?"golfer":"golfers"]})]})}},13028:function(e,l,s){s.d(l,{A:function(){return i}});var t=s(2265);let i=e=>{let{isOpen:l,setIsOpen:s}=e;return(0,t.useEffect)(()=>{let e=e=>{let{code:t}=e;l&&"Escape"===t&&s(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),(0,t.useEffect)(()=>{l?document.body.classList.add("overflow-hidden"):document.body.classList.remove("overflow-hidden")},[l]),{toggleSidebar:()=>{s(!l)}}}},75230:function(e,l,s){s.d(l,{eA:function(){return t.eA},kP:function(){return t.kP},w7:function(){return t.w7},zB:function(){return t.zB}});var t=s(78112)}}]);